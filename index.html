<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowPay - Programmable Payroll System</title>
    <link rel="icon" type="image/x-icon" href="https://www.genspark.ai/api/files/s/U1F4Wped?cache_control=3600">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@latest/dist/umd/index.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-shadow { box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .wallet-modal { backdrop-filter: blur(10px); }
        .animate-fade { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .gradient-text { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <img src="https://www.genspark.ai/api/files/s/U1F4Wped?cache_control=3600" alt="FlowPay" class="w-12 h-12 rounded-full">
                    <div>
                        <h1 class="text-2xl font-bold">FlowPay</h1>
                        <p class="text-blue-100 text-sm">Programmable Payroll System</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="connectWalletBtn" class="bg-white text-blue-600 px-6 py-2 rounded-lg font-semibold hover:bg-blue-50 transition duration-300">
                        <i class="fas fa-wallet mr-2"></i>Connect Wallet
                    </button>
                    <div id="walletInfo" class="hidden bg-white/20 px-4 py-2 rounded-lg">
                        <span id="walletAddress" class="text-sm"></span>
                        <button id="disconnectWallet" class="ml-2 text-blue-200 hover:text-white">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Welcome Section -->
        <div class="bg-white rounded-xl card-shadow p-8 mb-8 animate-fade">
            <div class="text-center">
                <h2 class="text-4xl font-bold gradient-text mb-4">Welcome to FlowPay</h2>
                <p class="text-gray-600 text-lg mb-6">Automate your payroll with smart contracts and blockchain technology</p>
                <div class="flex justify-center space-x-4">
                    <button id="registerCompanyBtn" class="bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                        <i class="fas fa-building mr-2"></i>Register Company
                    </button>
                    <button id="viewAnalyticsBtn" class="bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition duration-300">
                        <i class="fas fa-chart-line mr-2"></i>View Analytics
                    </button>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Company Info Card -->
            <div class="bg-white rounded-xl card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">Company Overview</h3>
                    <i class="fas fa-building text-blue-600 text-2xl"></i>
                </div>
                <div id="companyInfo" class="space-y-3">
                    <div class="text-center text-gray-500">
                        <i class="fas fa-building text-4xl mb-2"></i>
                        <p>No company registered yet</p>
                    </div>
                </div>
            </div>

            <!-- Employee Stats -->
            <div class="bg-white rounded-xl card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">Employee Stats</h3>
                    <i class="fas fa-users text-green-600 text-2xl"></i>
                </div>
                <div id="employeeStats" class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Total Employees:</span>
                        <span id="totalEmployees" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Active:</span>
                        <span id="activeEmployees" class="font-semibold text-green-600">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Monthly Budget:</span>
                        <span id="monthlyBudget" class="font-semibold">0 MNEE</span>
                    </div>
                </div>
            </div>

            <!-- Payment Status -->
            <div class="bg-white rounded-xl card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">Payment Status</h3>
                    <i class="fas fa-credit-card text-purple-600 text-2xl"></i>
                </div>
                <div id="paymentStatus" class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Last Payment:</span>
                        <span id="lastPayment" class="font-semibold">N/A</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Next Payment:</span>
                        <span id="nextPayment" class="font-semibold">N/A</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Success Rate:</span>
                        <span id="successRate" class="font-semibold text-green-600">100%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Employee Management Section -->
        <div class="mt-8 bg-white rounded-xl card-shadow p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-semibold text-gray-800">Employee Management</h3>
                <button id="addEmployeeBtn" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                    <i class="fas fa-plus mr-2"></i>Add Employee
                </button>
            </div>
            <div id="employeeTable" class="overflow-x-auto">
                <table class="w-full table-auto">
                    <thead>
                        <tr class="bg-gray-50">
                            <th class="px-4 py-3 text-left font-semibold text-gray-700">Name</th>
                            <th class="px-4 py-3 text-left font-semibold text-gray-700">Email</th>
                            <th class="px-4 py-3 text-left font-semibold text-gray-700">Position</th>
                            <th class="px-4 py-3 text-left font-semibold text-gray-700">Salary (MNEE)</th>
                            <th class="px-4 py-3 text-left font-semibold text-gray-700">Status</th>
                            <th class="px-4 py-3 text-left font-semibold text-gray-700">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="employeeTableBody">
                        <tr>
                            <td colspan="6" class="px-4 py-8 text-center text-gray-500">
                                <i class="fas fa-users text-4xl mb-2"></i>
                                <p>No employees added yet</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Analytics Dashboard -->
        <div id="analyticsSection" class="hidden mt-8">
            <div class="bg-white rounded-xl card-shadow p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800">Payroll Analytics</h3>
                    <div class="flex items-center space-x-4">
                        <select id="networkSelect" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="ethereum">Ethereum</option>
                            <option value="polygon">Polygon</option>
                            <option value="bsc">BNB Chain</option>
                            <option value="arbitrum">Arbitrum</option>
                        </select>
                        <button id="refreshAnalytics" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Analytics Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm">Total Volume</p>
                                <p id="totalVolume" class="text-2xl font-bold">0 MNEE</p>
                            </div>
                            <i class="fas fa-coins text-blue-200 text-2xl"></i>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-green-500 to-green-600 text-white rounded-xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm">Success Rate</p>
                                <p id="successRate" class="text-2xl font-bold">100%</p>
                            </div>
                            <i class="fas fa-check-circle text-green-200 text-2xl"></i>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Total Payments</p>
                                <p id="totalPayments" class="text-2xl font-bold">0</p>
                            </div>
                            <i class="fas fa-credit-card text-purple-200 text-2xl"></i>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-orange-100 text-sm">Network</p>
                                <p id="currentNetwork" class="text-2xl font-bold">Ethereum</p>
                            </div>
                            <i class="fas fa-network-wired text-orange-200 text-2xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div>
                        <h4 class="text-lg font-semibold mb-4">Payment Trends</h4>
                        <canvas id="paymentTrendsChart" style="height: 300px;"></canvas>
                    </div>
                    <div>
                        <h4 class="text-lg font-semibold mb-4">Payment Status</h4>
                        <canvas id="paymentStatusChart" style="height: 300px;"></canvas>
                    </div>
                </div>

                <!-- Transaction History -->
                <div class="mt-8">
                    <h4 class="text-lg font-semibold mb-4">Recent Transactions</h4>
                    <div id="transactionHistory" class="bg-gray-50 rounded-lg p-4">
                        <div class="text-center text-gray-500 py-8">
                            <i class="fas fa-history text-4xl mb-2"></i>
                            <p>Loading transaction history...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment Schedule Section -->
        <div class="mt-8 bg-white rounded-xl card-shadow p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-semibold text-gray-800">Payment Schedule</h3>
                <div class="flex items-center space-x-4">
                    <button id="scheduleSettings" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition duration-300">
                        <i class="fas fa-cog mr-2"></i>Settings
                    </button>
                    <button id="triggerPayments" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition duration-300">
                        <i class="fas fa-play mr-2"></i>Process Now
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                    <h4 class="text-lg font-semibold mb-4">Upcoming Payments</h4>
                    <div id="scheduledPayments" class="bg-gray-50 rounded-lg p-4">
                        <div class="text-center text-gray-500 py-8">
                            <i class="fas fa-calendar-alt text-4xl mb-2"></i>
                            <p>Loading scheduled payments...</p>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Schedule Status</h4>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-gray-600">Next Payment:</span>
                            <span id="nextPaymentDate" class="font-semibold">Calculating...</span>
                        </div>
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-gray-600">Schedule:</span>
                            <span id="currentSchedule" class="font-semibold capitalize">Monthly</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">Status:</span>
                            <span id="scheduleStatus" class="px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">Active</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <!-- Wallet Connection Modal -->
    <div id="walletModal" class="hidden fixed inset-0 bg-black/50 wallet-modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">Connect Your Wallet</h3>
            <div class="space-y-4">
                <button class="wallet-option w-full p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition duration-300 flex items-center space-x-3">
                    <img src="https://cryptologos.cc/logos/metamask-fox.svg" alt="MetaMask" class="w-8 h-8">
                    <span class="font-medium">MetaMask</span>
                </button>
                <button class="wallet-option w-full p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition duration-300 flex items-center space-x-3">
                    <img src="https://cryptologos.cc/logos/walletconnect.svg" alt="WalletConnect" class="w-8 h-8">
                    <span class="font-medium">WalletConnect</span>
                </button>
                <button class="wallet-option w-full p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition duration-300 flex items-center space-x-3">
                    <img src="https://cryptologos.cc/logos/coinbase-wallet.svg" alt="Coinbase Wallet" class="w-8 h-8">
                    <span class="font-medium">Coinbase Wallet</span>
                </button>
                <button class="wallet-option w-full p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition duration-300 flex items-center space-x-3">
                    <img src="https://cryptologos.cc/logos/trust-wallet.svg" alt="Trust Wallet" class="w-8 h-8">
                    <span class="font-medium">Trust Wallet</span>
                </button>
            </div>
            <button id="closeWalletModal" class="mt-6 w-full bg-gray-200 text-gray-800 py-2 rounded-lg font-semibold hover:bg-gray-300 transition duration-300">
                Close
            </button>
        </div>
    </div>

    <!-- Company Registration Modal -->
    <div id="companyModal" class="hidden fixed inset-0 bg-black/50 wallet-modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">Register Company</h3>
            <form id="companyForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Company Name</label>
                    <input type="text" id="companyName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="companyEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Payment Schedule</label>
                    <select id="paymentSchedule" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="monthly">Monthly</option>
                        <option value="biweekly">Bi-weekly</option>
                        <option value="weekly">Weekly</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Monthly Budget (MNEE)</label>
                    <input type="number" id="monthlyBudget" required min="0" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                        Register
                    </button>
                    <button type="button" id="closeCompanyModal" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg font-semibold hover:bg-gray-300 transition duration-300">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div id="employeeModal" class="hidden fixed inset-0 bg-black/50 wallet-modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">Add Employee</h3>
            <form id="employeeForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <input type="text" id="employeeName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="employeeEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Wallet Address</label>
                    <input type="text" id="employeeWallet" required placeholder="0x..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Position</label>
                    <input type="text" id="employeePosition" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Department</label>
                    <input type="text" id="employeeDepartment" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Monthly Salary (MNEE)</label>
                    <input type="number" id="employeeSalary" required min="0" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                        Add Employee
                    </button>
                    <button type="button" id="closeEmployeeModal" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg font-semibold hover:bg-gray-300 transition duration-300">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
            <p class="text-gray-600">Processing...</p>
        </div>
    </div>

    <script>
        // Global references for the application
        window.flowPay = null;
        window.walletManager = null;
        window.payStreamAnalytics = null;
        window.paymentScheduler = null;
    </script>
    <script src="js/app.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/scheduler.js"></script>
</body>
</html>